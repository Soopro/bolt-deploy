(function(){angular.module("boltApp",["ngSanitize","supLocales","supAngularWysiwyg"])}).call(this);(function(){angular.module("boltApp").filter("thumbnail",["config",function(e){return function(t,n){var r,i,a;if(!angular.isUrl(t)){return t}if(n===void 0){n="thumbnail"}r=e.cdn.engine;i={thumbnail:"/thumbnail/480x>/quality/90",favicon:"/thumbnail/180x180!/quality/90"};a=i[n];if(!a||!r){return t}if(t.indexOf(r)<0){if(t.match(/\?|#/)){t=t.split("?")[0].split("#")[0]}t+=r}t=t.replace(/\/thumbnail\/.*?$/i,"")+a;return t}}]).filter("bg_img",function(){return function(e){if(!e){return""}return"background-image:url("+e+");"}}).filter("is_empty",function(){return function(e){var t;if(angular.isArray(e)){t=!e||e.length<=0}else if(angular.isObject(e)){t=!e||Object.keys(e).length<=0}else if(angular.isFunction(e)||angular.isElement(e)){t=true}else{t=!Boolean(e)}return t}}).filter("price",function(){return function(e,t,n){return angular.price(e,t,n)}})}).call(this);(function(){angular.module("boltApp").config(["$sceDelegateProvider",function(e){return e.resourceUrlWhitelist(["self","http://**.soopro.io/**"])}])}).call(this);(function(){var e=[].indexOf;angular.module("boltApp").filter("trust",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).filter("url",["$rootScope",function(e){return function(t,n,r){var i;if(typeof t!=="string"){return t}if(n){i=t.indexOf("?");if(i>-1){t=t.substring(0,i)}}if(r){i=t.indexOf("#");if(i>-1){t=t.substring(0,i)}}if(!t||angular.isUrl(t)){return t}else if(angular.startswith(t,"/")){return e.base_url+"/"+t.replace(/(^\/)|(\/$)/g,"")}else{return t.replace(/\/$/g,"")}}}]).filter("path",["$rootScope",function(e){return function(t,n,r){var i,a,u;if(typeof t!=="string"){return t}if(n||n===void 0){a=t.indexOf("?");if(a>-1){t=t.substring(0,a)}}if(r||r===void 0){a=t.indexOf("#");if(a>-1){t=t.substring(0,a)}}try{u=t.split(e.base_url).pop()}catch(e){i=e;u=t}return"/"+u.replace(/^\//g,"").replace(/\/$/g,"")}}]).filter("active",["$rootScope",function(e){return function(e,t,n,r,i){var a,u,o,l,s;if(n===void 0){n=false}if(r===void 0){r="active"}if(i===void 0){i=""}if(!angular.isObject(e)||!angular.isString(t)){return i}a=function(n){var r;if(t===e.path){return true}else if(e.path_scope){r=angular.strip(e.path_scope,"/");if(angular.startswith(t,"/"+r+"/")){return true}}return false};if(a(e)){return r}if(n&&e.nodes){s=e.nodes;for(u=0,o=s.length;u<o;u++){l=s[u];if(a(l)){return r}}}return i}}]).filter("args",function(){return function(e,t){if(typeof e!=="string"){return{}}return angular.getURLParams(e,t)}}).filter("join",function(){return function(e,t){if(angular.isArray(e)){if(!t){t=", "}return e.join(t)}else{return e}}}).filter("striptags",function(){return function(e){return String(e).replace(/<[^>]+>/gm,"")}}).filter("int",function(){return function(e){try{e=parseInt(e)}catch(t){e=null}return e}}).filter("string",function(){return function(e){var t;try{t=e.toString()}catch(e){t=""}return t}}).filter("date_formatted",["$filter","$rootScope",function(e,t){return function(n,r){var i,a,u,o;if(!n){return""}if(typeof r!=="string"){r=null}a={en:"MMMM d, yyyy",zh:"yyyy年 MM月 dd日"};try{o=t.locale;u=t.lang||o.split("_")[0]}catch(e){o=null;u=null}i=r||a[o]||a[u]||null;if(typeof n==="number"){if(n.toString().length===10){n=n*1e3}}if(!i){return n}else{return e("date")(n,i)}}}]).filter("col_offset",function(){return function(t,n,r,i){var a,u,o;i=angular.parse_int(i,12,0);r=angular.parse_int(r,4,true);if(angular.isString(n)){if(e.call(n,"{}")<0){n+="{}"}}else{n=null}if(angular.isArray(t)){a=t.length}else{a=angular.parse_int(t,0,0)}u=Math.floor((i-a*r)/2);if(n){if(u>0){o=n.replace("{}",u)}else{o=""}}else{o=u}return o}})}).call(this);(function(){var e=[].indexOf;angular.module("boltApp").directive("editorCanvas",["$compile",function(t){return{restrict:"AE",scope:{},controller:["$scope","$rootScope","$element","$compile","$interval","$timeout","supLocales",function(t,n,r,i,a,u,o){var l,s,c,d,p,f,g,m,w,y,$,v,h,_,b;t._=angular.translate;if(window.parent){$=parent.angular.element(parent.document).scope()}else{$=n}h=$.station;if(!h){console.error("Canvas must running in an station.");return}p=h.editor_context;y=h.restEditor;_=h.strict_mode;if(_){console.info("Canvas running in Strict mode.")}t.g={};t.query={};f=p.metas;t.base_url=n.base_url=f.base_url;t.theme_url=n.theme_url=f.theme_url;t.lib_url=n.lib_url=f.lib_url;t.locale=n.locale=f.locale;t.lang=n.lang=f.lang;t.site_meta=f.site_meta;t.theme_meta=f.theme_meta;t.menu=f.menu;t.translates=f.translates;t.socials=f.socials;t.slot=f.slot;d=f.content_type[h.curr_content_type];t.content_type=d;t.visit=p.visit;c=function(e,n){h.display_canvas(false);return y.tpl.get({app_slug:e,tmpl_slug:n},function(e){var n,a,l;try{o.load(p.app.locale,e.localized_dict)}catch(e){a=e;console.error("Canvas localize error:",a)}r.html(e.tpl);if(_){b(r[0])}try{n=i(r.contents());n(t)}catch(e){a=e;console.error("Canvas rendering error:",a)}t.g={};t.query={};return l=u(function(){try{return h.display_canvas(true)}catch(e){a=e;return console.error(a)}},600)})};b=function(e){var t;t=e.querySelector("[sup-angular-wysiwyg]");if(t){t.setAttribute("readonly",true)}return e};m=null;t.$watch("file.template",function(e){if(m===e||!e){return}c(p.app.slug,e);return m=e});t.file=h.file;t.$watch("file",function(e){t.content=e.content;t.meta=e.meta||{};t.meta.id=e.id;t.meta.url=e.url;t.meta.path=e.path;t.meta.priority=e.priority;t.meta.parent=e.parent;t.meta.type=t.meta.content_type=e.content_type;t.meta.status=e.status;t.meta.updated=e.updated;t.meta.creation=e.creation;t.meta.date=e.date;t.meta.price=e.price;t.meta.template=e.template;t.meta.tags=e.tags;return t.meta.taxonomy=e.taxonomy},true);t.$watch("content",function(e){return t.file.content=e});if(_){n.escape=true}else{g={};l=function(e){var t,n,r;if(typeof e==="number"){e=[e]}for(n=0,r=e.length;n<r;n++){t=e[n];if(!g[t]){return false}}return true};r.on("keydown keyup",function(t){var r,i,a,u;a=[17,27];r=t.type==="keydown";if((u=t.keyCode,e.call(a,u)<0)||g[t.keyCode]===r){return}g[t.keyCode]=r;if(l(a)){i=!n.escape;h.switch_sidebar(!i);n.escape=i;return console.info("Editor: escape "+i)}})}v=[];s=n.$on("saw.loaded",function(e,t){if(typeof t.destroy==="function"){return v.push(t)}});t.$on("$destroy",function(){var e,t,n;for(e=0,t=v.length;e<t;e++){n=v[e];n.destroy()}s();return a.cancel(w)});return w=a(function(){},600)}]}}]).directive("supQuery",["$rootScope",function(e){return{scope:{attrs:"=",contentType:"=",sortby:"=",perpage:"=",paged:"=",taxonomy:"=",withContent:"="},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o,l,s,c,d,p;if(!i){return}l=3;o=document.querySelectorAll("[sup-query], sup-query");if(o.length>l){console.error("Query overrun.",n[0]);return}if(window.parent){c=parent.angular.element(parent.document).scope()}else{c=e}d=c.station;if(!d){return}a=d.editor_context.app;s=d.restEditor;if(p){p={slug:p.slug,term:p.term}}else{p={}}u={attrs:angular.list(t.attrs),content_type:t.contentType||r.supQuery,sortby:angular.list(t.sortby),perpage:angular.parse_int(t.perpage),paged:angular.parse_int(t.paged),taxonomy:p,with_content:angular.bool(t.withContent)};return s.doEditorQuery(a.id,u).then(function(e){return i.$setViewValue(e)})}}}]).directive("supTaxonomy",["$rootScope",function(e){return{scope:{taxonomy:"@"},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o,l,s,c;if(!i){return}o=3;u=document.querySelectorAll("[sup-taxonomy], sup-taxonomy");if(u.length>o){console.error("Query overrun.",n[0]);return}if(window.parent){s=parent.angular.element(parent.document).scope()}else{s=e}c=s.station;if(!c){return}a=c.editor_context.app;l=c.restEditor;if(r.supTaxonomy){t.taxonomy=r.supTaxonomy}return l.taxonomy.get({app_slug:a.slug,tax_slug:t.taxonomy},function(e){return i.$setViewValue(e)})}}}]).directive("supScriptLoader",[function(){return{restrict:"AE",replace:true,compile:function(e,t){var n;if(!t.src||typeof t.src!=="string"){return}n=document.createElement("script");n.setAttribute("ng-src","{{'"+t.src+"'}}");return e.append(n)}}}]).directive("supSet",[function(){return{scope:{value:"@",object:"="},restrict:"AE",require:"?ngModel",link:function(e,t,n,r){if(!r){return}r.$setViewValue(e.object||e.value);return r.$render=function(){return r.$setViewValue(e.object||e.value)}}}}]).directive("supBindHtml",function(){return{restrict:"A",compile:function(){return function(e,t,n){return e.$watch(n.supBindHtml,function(e){return t.html(e||"")})}}}}).directive("supTempalte",[function(){return{scope:{id:"@"},restrict:"E",transclude:true,replace:true,template:['<script type="text/ng-template" id="{{id}}">',"<ng-transclude></ng-transclude>","<\/script>"].join("")}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetBg",["$rootScope",function(e){return{scope:{allowTypes:"@",presets:"="},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o;if(!i){return}if(window.parent){u=parent.angular.element(parent.document).scope()}else{u=e}o=u.station;if(!o){return}t.options={allow_types:t.allowTypes||r.supWidgetBg,presets:t.presets};n.on("mousedown",function(e){if(o.strict_mode||e.target!==n[0]){return}o.$emit("widget.bg.update",t);return e.stopPropagation()});t.update=function(e){t.data=e;i.$setViewValue(t.data);return i.$render()};i.$render=function(){return t.data=i.$viewValue};a={label:r.label||r.name,key:r.ngModel};return o.$emit("widget.bg.loaded",a,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetAttrs",["$rootScope",function(e){return{scope:{structure:"="},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o,l,s,c,d,p;if(!i){return}if(window.parent){c=parent.angular.element(parent.document).scope()}else{c=e}d=c.station;if(!d){return}a={};if(angular.isArray(t.structure)){s=t.structure;for(u=0,o=s.length;u<o;u++){p=s[u];if(p.type===void 0){p.type="text"}if(p.key&&"default"in p){a[p.key]=p.default}}}t.options={structure:t.structure};n.on("mousedown",function(e){if(d.strict_mode){return}d.$emit("widget.attrs.update",t);return e.stopPropagation()});t.update=function(e){t.data=e||a;i.$setViewValue(t.data);return i.$render()};n.on("$destroy",function(){i.$render=angular.noop;if(angular.equals(i.$viewValue,a)){return i.$setViewValue(null)}});i.$render=function(){if(!angular.isDict(i.$viewValue)){i.$setViewValue(a)}return t.data=i.$viewValue};l={label:r.label||r.name,key:r.ngModel};return d.$emit("widget.attrs.loaded",l,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetLink",["$rootScope",function(e){return{scope:{allowTypes:"@"},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o;if(!i){return}if(window.parent){u=parent.angular.element(parent.document).scope()}else{u=e}o=u.station;if(!o){return}t.options={allow_types:t.allowTypes||r.supWidgetLink,content_type:r.contentType};n.on("mousedown",function(e){if(o.strict_mode){return}o.$emit("widget.link.update",t);return e.stopPropagation()});t.update=function(e){t.data=e;i.$setViewValue(t.data);return i.$render()};i.$render=function(){return t.data=i.$viewValue};a={label:r.label||r.name,key:r.ngModel};return o.$emit("widget.link.loaded",a,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetCarousel",["$rootScope",function(e){return{scope:{default:"@",allowTypes:"@",limit:"@"},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o,l,s,c,d,p,f;if(!i){return}if(window.parent){p=parent.angular.element(parent.document).scope()}else{p=e}f=p.station;if(!f){return}try{a=t.$eval(t.default);o=[];for(s=0,c=a.length;s<c;s++){u=a[s];o.push({title:u.title||"",src:u.src||"",type:u.type||"image",link:"#",target:"",caption:u.caption||"",misc:u.misc||""})}}catch(e){l=e;o=[]}if(!angular.isArray(o)){o=[]}t.limit=Math.min(angular.parse_int(t.limit,12,true),24);t.options={allow_types:t.allowTypes||r.supWidgetCarousel,content_type:r.contentType,lite:Boolean("lite"in r),limit:t.limit};n.on("mousedown",function(e){if(f.strict_mode){return}f.$emit("widget.carousel.update",t);return e.stopPropagation()});t.update=function(e){if(!e||e.length===0){e=null}t.data=e||o;i.$setViewValue(t.data);return i.$render()};n.on("$destroy",function(){i.$render=angular.noop;if(angular.equals(i.$viewValue,o)){return i.$setViewValue(null)}});i.$render=function(){if(!angular.isArray(i.$viewValue)){i.$setViewValue(o)}return t.data=i.$viewValue};d={label:r.label||r.name,key:r.ngModel};return f.$emit("widget.carousel.loaded",d,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetCreate",["$rootScope",function(e){return{scope:{type:"@",parent:"@",template:"@"},restrict:"AE",link:function(t,n,r){var i,a;if(window.parent){i=parent.angular.element(parent.document).scope()}else{i=e}a=i.station;if(!a||!a.create_file){return}return n.on("mousedown",function(e){if(a.strict_mode){return}a.create_file(t.type,t.template,t.parent||"");return e.stopPropagation()})}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetForm",["$rootScope",function(e){return{scope:{limit:"@",optLimit:"@",submitTypes:"@"},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o;if(!i){return}if(window.parent){u=parent.angular.element(parent.document).scope()}else{u=e}o=u.station;if(!o){return}t.options={limit:t.limit,opt_limit:t.optLimit,submit_types:t.submitTypes};n.on("mousedown",function(e){if(o.strict_mode){return}o.$emit("widget.form.update",t);return e.stopPropagation()});t.update=function(e){t.data=e;i.$setViewValue(t.data);return i.$render()};i.$render=function(){return t.data=i.$viewValue};a={label:r.label||r.name,key:r.ngModel};return o.$emit("widget.form.loaded",a,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetLines",["$rootScope",function(e){return{scope:{default:"@",limit:"@"},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o,l,s,c,d,p,f;if(!i){return}if(window.parent){d=parent.angular.element(parent.document).scope()}else{d=e}p=d.station;if(!p){return}try{a=t.$eval(t.default);u=[];for(l=0,s=a.length;l<s;l++){f=a[l];if(angular.isString(f)&&f){u.push({text:f})}else if(angular.isDict(f)&&f.text){u.push({text:f.text})}}}catch(e){o=e;u=[]}if(!angular.isArray(u)){u=[]}t.limit=Math.min(angular.parse_int(t.limit,12,true),24);t.options={limit:t.limit};n.on("mousedown",function(e){if(p.strict_mode){return}p.$emit("widget.lines.update",t);return e.stopPropagation()});t.update=function(e){t.data=e||u;i.$setViewValue(t.data);return i.$render()};n.on("$destroy",function(){i.$render=angular.noop;if(angular.equals(i.$viewValue,u)){return i.$setViewValue(null)}});i.$render=function(){if(!angular.isArray(i.$viewValue)){i.$setViewValue(u)}return t.data=i.$viewValue};c={label:r.label||r.name,key:r.ngModel};return p.$emit("widget.lines.loaded",c,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetMedia",["$rootScope",function(e){return{scope:{allowTypes:"@"},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o;if(!i){return}if(window.parent){u=parent.angular.element(parent.document).scope()}else{u=e}o=u.station;if(!o){return}t.options={allow_types:t.allowTypes||r.supWidgetMedia,lite:Boolean("lite"in r)};n.on("mousedown",function(e){if(o.strict_mode){return}o.$emit("widget.media.update",t);return e.stopPropagation()});t.update=function(e){t.data=e;i.$setViewValue(t.data);return i.$render()};i.$render=function(){return t.data=i.$viewValue};a={label:r.label||r.name,key:r.ngModel};return o.$emit("widget.media.loaded",a,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetOpen",["$rootScope",function(e){return{scope:{supWidgetOpen:"=",file:"="},restrict:"AE",link:function(t,n,r){var i,a;if(window.parent){i=parent.angular.element(parent.document).scope()}else{i=e}a=i.station;if(!a||!a.open_file){return}return n.on("mousedown",function(e){if(a.strict_mode){return}a.open_file(t.file||t.supWidgetOpen);return e.stopPropagation()})}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetScript",["$rootScope",function(e){return{scope:{},restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o;if(!i){return}if(window.parent){u=parent.angular.element(parent.document).scope()}else{u=e}o=u.station;if(!o){return}n.on("mousedown",function(e){if(o.strict_mode){return}o.$emit("widget.script.update",t);return e.stopPropagation()});t.update=function(e){t.data=e||"";i.$setViewValue(t.data);return i.$render()};i.$render=function(){return t.data=i.$viewValue};a={label:r.label||r.name,key:r.ngModel};return o.$emit("widget.script.loaded",a,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetSegments",["$rootScope",function(e){return{scope:{content_type:"@",parent:"@",limit:"@"},restrict:"AE",require:"ngModel",controller:["$scope",function(e){var t;t=this;t.$editSegment=function(t){if(e.strict_mode){return}return e.edit(t)};t.$createSegment=function(t){if(e.strict_mode){return}return e.create(t)};return t}],link:function(t,n,r,i){var a,u,o,l,s,c,d,p,f;if(!i){return}l=1;o=document.querySelectorAll("[sup-widget-segments], sup-widget-segments");if(o.length>l){console.error("Query overrun.",n[0]);return}if(window.parent){d=parent.angular.element(parent.document).scope()}else{d=e}p=d.station;if(!p){return}t.strict_mode=p.strict_mode;a=p.editor_context.app;u=p.file;c=p.restEditor;t.limit=Math.min(angular.parse_int(t.limit,24,true),24);t.data=[];f=function(e){var r;if(!e||!e.length){return}r=angular.element(n[0].querySelector("[segment-create]"));if(!r){return}if(e.length>=t.limit){return r.addClass("ng-hide")}else{return r.removeClass("ng-hide")}};s=function(){return c.segments.query({app_id:a.id,content_type:t.content_type||u.content_type,parent:t.parent||u.slug}).$promise.then(function(e){f(e);i.$setViewValue(e);return t.data=i.$viewValue})};s();t.refresh=function(){return s()};t.edit=function(e){if(!t.data[e]){return}return p.open_file(t.data[e])};return t.create=function(e){var n,r;n=t.content_type||u.content_type;r=t.parent||u.slug;return p.create_file(n,e,r,true)}}}}]).directive("segment",[function(){return{scope:false,restrict:"A",require:"?^supWidgetSegments",link:function(e,t,n,r){if(!r){return}return t.on("mousedown",function(t){if(!angular.isNumber(e.$index)){return}r.$editSegment(e.$index);return t.stopPropagation()})}}}]).directive("segmentCreate",[function(){return{scope:{template:"@"},restrict:"A",require:"?^supWidgetSegments",link:function(e,t,n,r){if(!r){return}return t.on("mousedown",function(t){r.$createSegment(e.template);return t.stopPropagation()})}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetSeries",["$rootScope",function(e){return{scope:{default:"@",allowTypes:"@",limit:"@"},restrict:"AE",require:"ngModel",controller:["$scope",function(e){this.$editSeriesItem=function(t){if(e.strict_mode){return}return e.edit(t)};this.$addSeriesItem=function(){if(e.strict_mode){return}return e.add()};return this}],link:function(t,n,r,i){var a,u,o,l,s,c,d,p,f,g,m,w;if(!i){return}if(window.parent){m=parent.angular.element(parent.document).scope()}else{m=e}w=m.station;if(!w){return}t.strict_mode=w.strict_mode;try{u=t.$eval(t.default);s=[];for(d=0,f=u.length;d<f;d++){p=u[d];s.push({src:p.src||"",type:p.type||"image",title:p.title||"",caption:p.caption||"",link:"",target:"",class:"",poster:p.poster||"",misc:p.misc||"",tags:p.tags||[]})}}catch(e){c=e;s=[]}if(!angular.isArray(s)){s=[]}t.limit=Math.min(angular.parse_int(t.limit,24,true),24);t.options={allow_types:t.allowTypes||r.supWidgetSeries,limit:t.limit};t.item=null;l=null;o=function(e){var r,i;r=n[0].querySelector("[series-item-create]");if(!e||!r){return}i=angular.element(r);if(e.length>=t.limit){i.addClass("ng-hide");if(e.length>t.limit){return e.length=t.limit}}else{return i.removeClass("ng-hide")}};a=function(){var e,n,r;t.item=null;l=null;r=t.data;for(e=0,n=r.length;e<n;e++){p=r[e];delete p._index}return o(t.data)};t.edit=function(e){if(!angular.isNumber(e)){return}l=e;t.item=t.data[e]||{};t.item._index=e;return w.$emit("widget.series.update",t)};t.add=function(){l=null;t.item=null;return w.$emit("widget.series.create",t)};t.update=function(e){var n;if(!angular.isObject(e)||e.deleted){t.data.splice(l,1)}else if(angular.isNumber(e._index)){t.data[l]=e;n=e._index;angular.list_shift(t.data,l,n,false)}return a()};t.create=function(e){var n;if(angular.isObject(e)){t.data.push(e)}l=t.data.length-1;if(e._index){n=e._index;angular.list_shift(t.data,l,n,false)}return a()};n.on("$destroy",function(){i.$render=angular.noop;if(angular.equals(i.$viewValue,s)){return i.$setViewValue(null)}});i.$render=function(){if(!angular.isArray(i.$viewValue)){i.$setViewValue(s)}t.data=i.$viewValue;return o(t.data)};g={label:r.label||r.name,key:r.ngModel};return w.$emit("widget.series.loaded",g,t)}}}]).directive("seriesItem",[function(){return{scope:false,restrict:"A",require:"?^supWidgetSeries",link:function(e,t,n,r){if(!r){return}return t.on("mousedown",function(t){if(!angular.isNumber(e.$index)){return}r.$editSeriesItem(e.$index);return t.stopPropagation()})}}}]).directive("seriesItemCreate",[function(){return{scope:false,restrict:"A",require:"?^supWidgetSeries",link:function(e,t,n,r){if(!r){return}return t.on("mousedown",function(e){r.$addSeriesItem();return e.stopPropagation()})}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetText",["$rootScope","$timeout","$interpolate",function(e,t,n){return{scope:{default:"@"},restrict:"AE",require:"?ngModel",link:function(r,i,a,u){var o,l,s,c,d,p,f,g,m;if(!u){return}if(window.parent){g=parent.angular.element(parent.document).scope()}else{g=e}m=g.station;if(!m){return}c=false;if(!m.strict_mode){i[0].setAttribute("contenteditable","true")}if(r.default){s=r.default}else{s=n(i.html().trim())(e)}i.on("click mousedown",function(e){if(m.strict_mode){return}m.$emit("widget.text.touch",r);return e.stopPropagation()});u.$render=function(){var e;if(!u.$viewValue&&!c){i.html(s);e=t(function(){f();return t.cancel(e)},0)}else{i.html(u.$viewValue||"")}return c=true};i.on("blur keyup change cut",function(e){if(m.strict_mode){return}f();return e.stopPropagation()});o=function(e){e=e.replace(/<div\s*.*?>/gi,"<br>");e=e.replace(/<(?!br\s*\/?)[^>]+>/gi,"");if(e==="<br>"){e=""}return e};l=function(e){var t,n,r,i;e.removeAttribute("style");i=e.children;for(n=0,r=i.length;n<r;n++){t=i[n];l(t)}};d=function(e){var t,n,r;r=void 0;n=void 0;t=void 0;if(window.getSelection){r=window.getSelection();if(r.getRangeAt&&r.rangeCount){n=r.getRangeAt(0);n.deleteContents();n.insertNode(document.createTextNode(e))}}else if(document.selection&&document.selection.createRange){document.selection.createRange().text=e}};i.on("paste",function(e){var t;if(m.strict_mode){return}if(e.clipboardData&&e.clipboardData.getData){e.preventDefault();t=e.clipboardData.getData("text/plain");return document.execCommand("insertHTML",false,t)}else if(window.clipboardData&&window.clipboardData.getData){t=window.clipboardData.getData("Text");return d(t)}});f=function(){var e;e=o(i.html());if(e==="<br>"){e=""}return u.$setViewValue(e.trim())};p={label:a.label||a.name,key:a.ngModel};return m.$emit("widget.text.loaded",p,r)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetShelf",["$rootScope",function(e){return{scope:null,restrict:"AE",require:"?ngModel",link:function(t,n,r,i){var a,u,o,l,s,c,d;if(!i){return}if(window.parent){c=parent.angular.element(parent.document).scope()}else{c=e}d=c.station;if(!d){return}a=d.editor_context.app;s=d.restEditor;u=false;l=function(e){if(e&&e.commodity_id){return s.doEditorShelf(a.id,{shelf:e}).then(function(e){i.$setViewValue(e.shelf);return i.$render()})}else{i.$setViewValue(null);return i.$render()}};n.on("mousedown",function(e){if(d.strict_mode){return}d.$emit("widget.shelf.update",t);return e.stopPropagation()});t.update=function(e){return l(e)};i.$render=function(){t.data=i.$viewValue;if(!u){l(t.data);return u=true}};o={label:r.label||r.name,key:r.ngModel};return d.$emit("widget.shelf.loaded",o,t)}}}])}).call(this);(function(){angular.module("boltApp").directive("supWidgetSlot",["$rootScope",function(e){return{scope:{allowTypes:"@",key:"@"},restrict:"AE",link:function(t,n,r){var i,a,u;if(window.parent){a=parent.angular.element(parent.document).scope()}else{a=e}u=a.station;if(!u||!u.edit_slot){return}t.options={allow_types:t.allowTypes||r.supWidgetSlot};n.on("mousedown",function(e){return u.strict_mode;u.edit_slot(t.key,t.options);return e.stopPropagation()});i={label:r.label||r.name,key:t.key};return u.$emit("widget.slot.loaded",i,t)}}}])}).call(this);
